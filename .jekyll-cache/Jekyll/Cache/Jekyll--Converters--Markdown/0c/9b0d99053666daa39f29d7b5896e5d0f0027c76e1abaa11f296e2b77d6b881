I"—+<p>ë°ì´í„° í•œ ì¤„ë§ˆë‹¤ log_idê°€ ê°ê° ë¶™ì–´ ìˆê³  team_idë³„ë¡œ ëª‡ ê°œì˜ log_idê°€ ìˆëŠ”ì§€ êµ¬í•˜ë ¤ëŠ” ê²Œ ëª©í‘œ</p>

<p>ë™ì¼í•œ ì¢…ë¥˜ì˜ ë°ì´í„°ì¸ë° 1ì–µ ì¤„ì´ ë„˜ì–´ì„œ ë©”ëª¨ë¦¬ ì—ëŸ¬ê°€ ë°œìƒí–ˆì—ˆìŒ</p>

<p>ì²˜ìŒì— ë°ì´í„° ê²°ê³¼ë¥¼ SQLë¡œ ë¹¼ë‚´ì„œ ì €ì¥í•  ë•Œ 1.txt, 2.txtâ€¦ 5ê°œë¥¼ ë§Œë“¤ì–´ë‘ </p>

<p><strong>ì„±ê³µ ì½”ë“œ</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ë°˜ë³µë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì„±ê³µí•œ ì½”ë“œ
</span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
  
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s">".txt"</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">)</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team_id'</span><span class="p">).</span><span class="n">agg</span><span class="p">({</span><span class="s">'tp_acquire_log_id'</span><span class="p">:</span> <span class="s">'count'</span><span class="p">})</span>
    <span class="n">df</span><span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
 
<span class="c1"># team_id ë³„ë¡œ ì—¬ëŸ¬ ê°œì˜ ê°’ì´ ìˆì–´ì„œ ë‹¤ì‹œ ë”í•´ì£¼ê¸°
</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team_id'</span><span class="p">).</span><span class="n">agg</span><span class="p">({</span><span class="s">'tp_acquire_log_id'</span><span class="p">:</span><span class="s">'sum'</span><span class="p">})</span>
 
<span class="c1"># ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'tp_acquire_log_id'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span> <span class="p">)</span>
</code></pre></div></div>

<p><img src="../../../../img/2022-01-09-bulk_data/data.png" alt="data" style="zoom: 80%;" /></p>

<hr />

<p><strong>ì²˜ìŒì— ì‹¤íŒ¨í–ˆë˜ ì½”ë“œ</strong></p>

<ul>
  <li>ì´ 1.5ì–µ ì¤„ ì •ë„ ë˜ë‹¤ ë³´ë‹ˆ group by, countì—ì„œ ì—ëŸ¬ ë°œìƒ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
 
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>


<span class="n">df6</span> <span class="o">=</span> <span class="n">df1</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">df2</span><span class="p">,</span><span class="n">df3</span><span class="p">,</span><span class="n">df4</span><span class="p">,</span><span class="n">df5</span><span class="p">],</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">df7</span> <span class="o">=</span> <span class="n">df6</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team_id'</span><span class="p">)[</span><span class="s">'tp_acquire_log_id'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span> <span class="c1">#ì—¬ê¸°ì„œ ë©”ëª¨ë¦¬ ì—ëŸ¬ ë°œìƒ 
</span></code></pre></div></div>

<hr />

<p><strong>ë‘ ë²ˆì§¸ ì‹¤íŒ¨í–ˆë˜ ì½”ë“œ</strong></p>

<ul>
  <li>ê°ê° group by í›„ì— ë”í•˜ê¸° ì‹œë„
    <ul>
      <li>team_id ë“¤ì´ df1_1 ~ df5_1ì— ê³µí†µì ìœ¼ë¡œ ìˆì§€ ì•Šìœ¼ë©´ NaN ì´ ëœ¨ë©´ì„œ ì—ëŸ¬ ë°œìƒ</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
 
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>
<span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'1.txt'</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">)</span>


<span class="n">df1_1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team_id'</span><span class="p">)[</span><span class="s">'tp_acquire_log_id'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
<span class="n">df2_1</span> <span class="o">=</span> <span class="n">df2</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team_id'</span><span class="p">)[</span><span class="s">'tp_acquire_log_id'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
<span class="n">df3_1</span> <span class="o">=</span> <span class="n">df3</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team_id'</span><span class="p">)[</span><span class="s">'tp_acquire_log_id'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
<span class="n">df4_1</span> <span class="o">=</span> <span class="n">df4</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team_id'</span><span class="p">)[</span><span class="s">'tp_acquire_log_id'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
<span class="n">df5_1</span> <span class="o">=</span> <span class="n">df5</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team_id'</span><span class="p">)[</span><span class="s">'tp_acquire_log_id'</span><span class="p">].</span><span class="n">count</span><span class="p">()</span>
 
 
<span class="n">df6</span> <span class="o">=</span> <span class="n">df1_1</span> <span class="o">+</span> <span class="n">df2_1</span> <span class="o">+</span> <span class="n">df3_1</span> <span class="o">+</span> <span class="n">df4_1</span> <span class="o">+</span> <span class="n">df5_1</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df6</span><span class="p">)</span>
<span class="n">df7</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'tp_acquire_log_id'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>
:ET