<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<p>roster라는 컬럼에 아래와 같은 형식으로 json 파일이 들어있다</p>

<p>{“bats”:[{“playerId”:7812,”pos”:”B3”},{“playerId”:192032,”pos”:”DH”},{“playerId”:804,”pos”:”B1”},{“playerId”:182056,”pos”:”LF”},{“playerId”:9804,”pos”:”CF”},{“playerId”:1805,”pos”:”RF”},{“playerId”:51139,”pos”:”SS”},{“playerId”:182045,”pos”:”C”},{“playerId”:7822,”pos”:”B2”}],”sps”:[192011,82807,202046,212010,7803],”rps”:[8806,10804,12812,50099],”cp”:93820,”coaches”:[{“playerId”:9852,”role”:”HEAD”},{“playerId”:6821,”role”:”HIT”},{“playerId”:715210,”role”:”DF”},{“playerId”:700208,”role”:”RUN”},{“playerId”:6808,”role”:”PIT”},{“playerId”:93822,”role”:”BULLPEN”}],”deck”:{“@type”:”GeneralDeck”,”year”:null,”teamCode”:”doosan”,”grade”:”S”}}</p>

<p>.</p>

<p>mysql로 처리하면 다음과 같다</p>

<ul>
  <li>bats와 coaches에는 pos와 role이 랜덤한 순서로 있어서 json_search 사용</li>
  <li>sps와 rps에는 순서대로 있어서 list에서 꺼내는 형식 사용</li>
  <li>cp는 숫자만 들어 있어서 숫자만</li>
  <li>deck에서는 특정 키를 지정</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">ladder_id</span><span class="p">,</span> <span class="n">team_id</span><span class="p">,</span> 
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'C'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="k">C</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'B1'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">B1</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'B2'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">B2</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'B3'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">B3</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'SS'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">SS</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'LF'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">LF</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'CF'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">CF</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'RF'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">RF</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'DH'</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">DH</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.sps[0]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">sp1</span><span class="p">,</span> 
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.sps[1]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">sp2</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.sps[2]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">sp3</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.sps[3]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">sp4</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.sps[4]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">sp5</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.rps[0]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">rp1</span><span class="p">,</span> 
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.rps[1]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">rp2</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.rps[2]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">rp3</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.rps[3]'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">rp4</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.cp'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">cp</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'HEAD'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">HEAD</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'PIT'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">PIT</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'BULLPEN'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">BULLPEN</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'HIT'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">HIT</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'RUN'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">RUN</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'DF'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">DF</span><span class="p">,</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.deck[0].year'</span><span class="p">)</span>  <span class="k">as</span> <span class="n">year_info</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.deck[0].teamCode'</span><span class="p">))</span>  <span class="k">as</span> <span class="n">teamCode</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.deck[0].grade'</span><span class="p">))</span>  <span class="k">as</span> <span class="n">grade</span>
<span class="k">from</span> <span class="n">ladder_team_roster</span>
<span class="k">where</span> <span class="n">ladder_id</span><span class="o">&gt;</span> <span class="mi">20220101</span> 
<span class="k">limit</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="../../../../img/2022-02-13-sql_json1/image-20220213193929134.png" alt="image-20220213193929134"></p>

<p><img src="../../../../img/2022-02-13-sql_json1/image-20220213193939505.png" alt="image-20220213193939505"></p>

<p>.</p>

<p>.</p>

<p>작동 방식</p>

<ul>
  <li>json_search와 concat 활용</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'HEAD'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">),</span> <span class="o">#</span> <span class="n">concat</span> <span class="err">결과</span> <span class="err">값</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'HEAD'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'"playerId"'</span><span class="p">)),</span> <span class="o">#</span><span class="n">playerId</span><span class="err">에</span> <span class="err">따옴표</span> <span class="err">붙인</span> <span class="err">경우</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="n">concat</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span> <span class="s1">'HEAD'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">),</span><span class="s1">'playerId'</span><span class="p">)),</span> <span class="o">#</span><span class="n">playerId</span><span class="err">에</span> <span class="err">따옴표</span> <span class="err">안</span> <span class="err">붙인</span> <span class="err">경우</span> <span class="p">:</span> <span class="err">붙인</span> <span class="err">경우와</span> <span class="err">결과는</span> <span class="err">같다</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span><span class="s1">'$.coaches[0]'</span><span class="p">),</span> <span class="o">#</span><span class="n">coaches</span> <span class="err">키값에서</span> <span class="err">첫번째</span> <span class="err">값</span><span class="p">.</span> <span class="n">HEAD</span><span class="err">일</span> <span class="err">수도</span> <span class="n">PIT</span><span class="err">일</span> <span class="err">수도</span> <span class="err">있고</span> <span class="err">다양하다</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span><span class="s1">'$.coaches[0].playerId'</span><span class="p">),</span> <span class="o">#</span><span class="err">첫번째</span> <span class="n">playerId</span>
<span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span><span class="s1">'$.coaches[0].role'</span><span class="p">),</span> <span class="o">#</span><span class="err">첫번째</span> <span class="k">role</span>
<span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span><span class="s1">'all'</span><span class="p">,</span><span class="s1">'PIT'</span><span class="p">),</span> <span class="o">#</span><span class="n">json_search</span> <span class="err">함수</span><span class="p">.</span> <span class="err">전체</span> <span class="err">중</span> <span class="n">PIT</span> <span class="err">값이</span> <span class="err">있는</span> <span class="err">첫</span> <span class="err">번째</span> <span class="err">자리를</span> <span class="err">알아내와라</span>
<span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span><span class="s1">'all'</span><span class="p">,</span><span class="s1">'DF'</span><span class="p">),</span> <span class="o">#</span><span class="n">json_search</span> <span class="err">함수</span><span class="p">.</span> <span class="err">전체</span> <span class="err">중</span> <span class="n">DF</span> <span class="err">값이</span> <span class="err">있는</span> <span class="err">첫</span> <span class="err">번째</span> <span class="err">자리를</span> <span class="err">알아내와라</span>
<span class="n">substr</span><span class="p">(</span><span class="n">json_search</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'all'</span><span class="p">,</span><span class="s1">'PIT'</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span> <span class="o">#</span><span class="n">PIT</span><span class="err">값이</span> <span class="err">있늦</span> <span class="err">자리를</span> <span class="err">알아내온</span> <span class="err">후</span><span class="p">,</span> <span class="err">그</span> <span class="err">문자열을</span> <span class="err">두번째부터</span> <span class="mi">13</span><span class="err">번쩨</span> <span class="err">전까지</span> <span class="err">잘라라</span>
<span class="k">from</span> <span class="n">ladder_team_roster</span>
<span class="k">where</span> <span class="n">ladder_id</span><span class="o">&gt;</span><span class="mi">20220101</span> <span class="k">limit</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="../../../../img/2022-02-13-sql_json1/image-20220213200240404.png" alt="image-20220213200240404"></p>

<p><img src="../../../../img/2022-02-13-sql_json1/image-20220213200310653.png" alt="image-20220213200310653"></p>

<p><img src="../../../../img/2022-02-13-sql_json1/image-20220213200325656.png" alt="image-20220213200325656"></p>

<p><img src="../../../../img/2022-02-13-sql_json1/image-20220213200340328.png" alt="image-20220213200340328"></p>

<p>.</p>

<p>.</p>

<hr>

<p>case when을 써서 무식하게 지정하는 방식도 있지만 concat을 쓰는 편이 훨씬 깔끔했다</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">ladder_id</span><span class="p">,</span> <span class="n">team_id</span><span class="p">,</span> 
<span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="n">bat1_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat1</span>  
<span class="k">when</span> <span class="n">bat2_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat2</span>
<span class="k">when</span> <span class="n">bat3_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat3</span>
<span class="k">when</span> <span class="n">bat4_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat4</span>
<span class="k">when</span> <span class="n">bat5_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat5</span>
<span class="k">when</span> <span class="n">bat6_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat6</span>
<span class="k">when</span> <span class="n">bat7_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat7</span>
<span class="k">when</span> <span class="n">bat8_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat8</span>
<span class="k">when</span> <span class="n">bat9_pos</span> <span class="o">=</span> <span class="s1">'C'</span> <span class="k">then</span> <span class="n">bat9</span>
<span class="k">end</span><span class="p">)</span> <span class="k">as</span> <span class="k">C</span>
<span class="k">from</span>
<span class="p">(</span>
<span class="k">select</span> <span class="n">ladder_id</span><span class="p">,</span> <span class="n">team_id</span><span class="p">,</span> 
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[0]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat1_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[0]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat1</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[1]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat2_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[1]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat2</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[2]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat3_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[2]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat3</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[3]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat4_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[3]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat4</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[4]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat5_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[4]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat5</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[5]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat6_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[5]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat6</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[6]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat7_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[6]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat7</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[7]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat8_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[7]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat8</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[8]."pos"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat9_pos</span><span class="p">,</span>
<span class="n">json_unquote</span><span class="p">(</span><span class="n">json_extract</span><span class="p">(</span><span class="n">roster</span><span class="p">,</span> <span class="s1">'$.bats[8]."playerId"'</span><span class="p">))</span> <span class="k">as</span> <span class="n">bat9</span>
<span class="k">from</span> <span class="n">ladder_team_roster</span> 
<span class="p">)</span> <span class="n">x</span> 
<span class="k">where</span> <span class="n">x</span><span class="p">.</span><span class="n">ladder_id</span><span class="o">&gt;</span> <span class="mi">20220101</span>
<span class="k">limit</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="../../../../img/2022-02-13-sql_json1/image-20220213200414785.png" alt="image-20220213200414785"></p>
</body></html>
